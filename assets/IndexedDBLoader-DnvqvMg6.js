import{r as a,j as s}from"./react-C3EGSwTV.js";import{F as d,ab as w,e as T,I as b}from"./app-routes-DOYk1v_t.js";import{U as x}from"./AttachFileContainerFile-BlcBDjOi.js";const j="_TransitionBetweenBlocks__disappear_1wakk_1",I="_blockdisappear_1wakk_1",V="_TransitionBetweenBlocks__appear_1wakk_17",h="_blockappear_1wakk_1",B={TransitionBetweenBlocks__disappear:j,blockdisappear:I,TransitionBetweenBlocks__appear:V,blockappear:h},E=({className:u,blocks:i,transitionDuration:t,defaultIndex:r,defaultIsMounted:c=!1})=>{const[e,n]=a.useState(i[r]),[o,m]=a.useState(null),l=a.useRef(),p=a.useRef(c);return a.useEffect(()=>{if(p.current&&!l.current)for(const k of i)k.condition&&k.id!==(e==null?void 0:e.id)&&(m(e),n(null),l.current=setTimeout(()=>{l.current=null,p.current=!0,n(k);const f=setTimeout(()=>{m(null),clearTimeout(f)},90);clearTimeout(l.current)},t));else p.current=!0},[i,t,e]),s.jsxs(d,{max:!0,align:"center",justify:"center",className:u,children:[o&&s.jsx(d,{max:!0,"data-testid":o["data-testid"]||"TransitionBetweenBlocks.PastVisibleBlock",className:B.TransitionBetweenBlocks__disappear,style:{animationDuration:`${t+100}ms`},children:o.component}),p.current?e&&s.jsx(d,{max:!0,"data-testid":e["data-testid"]||"TransitionBetweenBlocks.VisibleBlock",style:{animationDuration:`${t}ms`},className:B.TransitionBetweenBlocks__appear,children:e.component}):s.jsx(s.Fragment,{children:e&&s.jsx(d,{max:!0,"data-testid":e["data-testid"]||"TransitionBetweenBlocks.VisibleBlock",children:e.component})})]})},_=new x,R=a.memo(({children:u,setFiles:i,indexedDB:t,indexedDBStoreName:r})=>{const c=a.useCallback(async e=>{const n=await _.fetchLoadedFiles(e,r);n&&i(n.map(o=>o.file))},[r,i]);return a.useEffect(()=>{w||(async()=>(t.current=await _.openDatabase(T,1,b.map(n=>n.name)),c(t.current)))()},[t,c]),s.jsx(s.Fragment,{children:u})});export{R as I,E as T};
