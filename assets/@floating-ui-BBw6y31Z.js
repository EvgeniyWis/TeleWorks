const _=Math.min,I=Math.max,R=Math.round,x=Math.floor,O=t=>({x:t,y:t});function $(t){const{x:e,y:n,width:i,height:o}=t;return{width:i,height:o,top:n,left:e,right:e+i,bottom:n+o,x:e,y:n}}function A(t){return V(t)?(t.nodeName||"").toLowerCase():"#document"}function g(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function B(t){var e;return(e=(V(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function V(t){return t instanceof Node||t instanceof g(t).Node}function q(t){return t instanceof Element||t instanceof g(t).Element}function C(t){return t instanceof HTMLElement||t instanceof g(t).HTMLElement}function D(t){return typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof g(t).ShadowRoot}function W(t){const{overflow:e,overflowX:n,overflowY:i,display:o}=L(t);return/auto|scroll|overlay|hidden|clip/.test(e+i+n)&&!["inline","contents"].includes(o)}function P(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function U(t){return["html","body","#document"].includes(A(t))}function L(t){return g(t).getComputedStyle(t)}function j(t){if(A(t)==="html")return t;const e=t.assignedSlot||t.parentNode||D(t)&&t.host||B(t);return D(e)?e.host:e}function H(t){const e=j(t);return U(e)?t.ownerDocument?t.ownerDocument.body:t.body:C(e)&&W(e)?e:H(e)}function F(t,e,n){var i;e===void 0&&(e=[]),n===void 0&&(n=!0);const o=H(t),c=o===((i=t.ownerDocument)==null?void 0:i.body),r=g(o);if(c){const s=k(r);return e.concat(r,r.visualViewport||[],W(o)?o:[],s&&n?F(s):[])}return e.concat(o,F(o,[],n))}function k(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function K(t){const e=L(t);let n=parseFloat(e.width)||0,i=parseFloat(e.height)||0;const o=C(t),c=o?t.offsetWidth:n,r=o?t.offsetHeight:i,s=R(n)!==c||R(i)!==r;return s&&(n=c,i=r),{width:n,height:i,$:s}}function N(t){return q(t)?t:t.contextElement}function M(t){const e=N(t);if(!C(e))return O(1);const n=e.getBoundingClientRect(),{width:i,height:o,$:c}=K(e);let r=(c?R(n.width):n.width)/i,s=(c?R(n.height):n.height)/o;return(!r||!Number.isFinite(r))&&(r=1),(!s||!Number.isFinite(s))&&(s=1),{x:r,y:s}}const X=O(0);function Y(t){const e=g(t);return!P()||!e.visualViewport?X:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function G(t,e,n){return!1}function z(t,e,n,i){e===void 0&&(e=!1);const o=t.getBoundingClientRect(),c=N(t);let r=O(1);e&&(r=M(t));const s=G()?Y(c):O(0);let a=(o.left+s.x)/r.x,u=(o.top+s.y)/r.y,v=o.width/r.x,p=o.height/r.y;if(c){const y=g(c),d=i;let w=y,f=w.frameElement;for(;f&&i&&d!==w;){const m=M(f),l=f.getBoundingClientRect(),h=L(f),b=l.left+(f.clientLeft+parseFloat(h.paddingLeft))*m.x,E=l.top+(f.clientTop+parseFloat(h.paddingTop))*m.y;a*=m.x,u*=m.y,v*=m.x,p*=m.y,a+=b,u+=E,w=g(f),f=w.frameElement}}return $({width:v,height:p,x:a,y:u})}function J(t,e){let n=null,i;const o=B(t);function c(){var s;clearTimeout(i),(s=n)==null||s.disconnect(),n=null}function r(s,a){s===void 0&&(s=!1),a===void 0&&(a=1),c();const{left:u,top:v,width:p,height:y}=t.getBoundingClientRect();if(s||e(),!p||!y)return;const d=x(v),w=x(o.clientWidth-(u+p)),f=x(o.clientHeight-(v+y)),m=x(u),h={rootMargin:-d+"px "+-w+"px "+-f+"px "+-m+"px",threshold:I(0,_(1,a))||1};let b=!0;function E(T){const S=T[0].intersectionRatio;if(S!==a){if(!b)return r();S?r(!1,S):i=setTimeout(()=>{r(!1,1e-7)},1e3)}b=!1}try{n=new IntersectionObserver(E,{...h,root:o.ownerDocument})}catch{n=new IntersectionObserver(E,h)}n.observe(t)}return r(!0),c}function Q(t,e,n,i){i===void 0&&(i={});const{ancestorScroll:o=!0,ancestorResize:c=!0,elementResize:r=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:a=!1}=i,u=N(t),v=o||c?[...u?F(u):[],...F(e)]:[];v.forEach(l=>{o&&l.addEventListener("scroll",n,{passive:!0}),c&&l.addEventListener("resize",n)});const p=u&&s?J(u,n):null;let y=-1,d=null;r&&(d=new ResizeObserver(l=>{let[h]=l;h&&h.target===u&&d&&(d.unobserve(e),cancelAnimationFrame(y),y=requestAnimationFrame(()=>{var b;(b=d)==null||b.observe(e)})),n()}),u&&!a&&d.observe(u),d.observe(e));let w,f=a?z(t):null;a&&m();function m(){const l=z(t);f&&(l.x!==f.x||l.y!==f.y||l.width!==f.width||l.height!==f.height)&&n(),f=l,w=requestAnimationFrame(m)}return n(),()=>{var l;v.forEach(h=>{o&&h.removeEventListener("scroll",n),c&&h.removeEventListener("resize",n)}),p==null||p(),(l=d)==null||l.disconnect(),d=null,a&&cancelAnimationFrame(w)}}export{Q as a};
